language: php
php:
  - '7.0'
  - '7.1'

install:
  - travis_retry composer install --no-interaction

before_script:
    - mkdir -p build/merge
    - mkdir -p build/logs

script:
  - ./bin/phpspec run
  - ./bin/phpunit --coverage-clover build/merge/phpunit.xml
  - ./bin/phpcov merge --clover ./build/logs/clover.xml ./build/merge

after_success:
  - cat ./build/logs/clover.xml
  - ./bin/coveralls -v -r .

branches:
  only: master